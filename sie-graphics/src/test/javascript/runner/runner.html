<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/mocha.css" />
    <link rel="stylesheet" href="../../../../target/metamac.css" />
</head>

<body>

    <div id="mocha"></div>
    <script src="js/mocha.js"></script>
    <script src="js/chai.js"></script>
    <script src="js/sinon.js"></script>
    <script>
        mocha.setup('bdd');
        mocha.ui('bdd');
        mocha.reporter('html');
        expect = chai.expect;
    </script>
    <script src="js/bridge.js"></script>

    <script>
        var jsPath = "../../../main/webapp/WEB-INF/theme/js/";
        var testPath = "../specs/";

        var src = ["../../../../target/metamac.js"];

        var tests = [
            testPath + "utils/SpecUtils.js",
            testPath + "test/factories/FilterOptionsFactory.js",
            testPath + "App.spec.js",
            // testPath + "FullScreen.spec.js",
            testPath + "FilterOptions-spec.js",
            testPath + "FilterOptionsDimensionRestriction-spec.js",
            testPath + "components/tooltip/Tooltip.spec.js",
            testPath + "dataset/MetadataResponse.js",
            testPath + "dataset/DatasetIdentifier.js",
            testPath + "dataset/Metadata.spec.js",
            testPath + "dataset/Data.spec.js",
            testPath + "dataset/Attributes.spec.js",
            testPath + "dataset/NumberFormatter.spec.js",
            testPath + "libs/HandlebarsHelpers.spec.js",
            testPath + "libs/DB.spec.js",
            testPath + "svg/Exporter.spec.js",
            testPath + "svg/SVGNode.spec.js",


            testPath + "modules/dataset/filter/sidebar/OrderSidebarView.spec.js",
            testPath + "modules/dataset/filter/sidebar/FilterSidebarDimensionView.spec.js",
            testPath + "modules/dataset/filter/sidebar/FilterSidebarView.spec.js",
            testPath + "modules/dataset/filter/sidebar/FilterSidebarCategoryView.spec.js",

            testPath + "dataset/DataIndicatorResponse.js",
            testPath + "dataset/IndicatorDataResponse.spec.js",
            testPath + "dataset/DataResponse.spec.js",
            testPath + "dataset/DataResponse.js",

            testPath + "visual-element/table/DataSourceMock.js",
            testPath + "visual-element/table/Stubs.js",
            testPath + "visual-element/table/primitives/Rectangle-spec.js",
            testPath + "visual-element/table/zones/BodyZone-spec.js",
            testPath + "visual-element/table/zones/BottomScrollZone-spec.js",
            testPath + "visual-element/table/zones/LeftHeaderZone-spec.js",
            testPath + "visual-element/table/zones/RightScrollZone-spec.js",
            testPath + "visual-element/table/zones/TopHeaderZone-spec.js",
            testPath + "visual-element/table/zones/Zone-spec.js",
            testPath + "visual-element/table/DataSource-spec.js",
            testPath + "visual-element/table/DataSourceDataset.spec.js",
            testPath + "visual-element/table/Delegate-spec.js",
            testPath + "visual-element/table/ScrollManager-spec.js",
            testPath + "visual-element/table/Util-spec.js",
            testPath + "visual-element/table/View-spec.js",

            testPath + "modules/dataset/filter/models/FilterDimensions.spec.js",
            testPath + "modules/dataset/filter/models/FilterDimension.spec.js",
            testPath + "modules/dataset/filter/models/FilterRepresentation.spec.js",
            testPath + "modules/dataset/filter/models/FilterRepresentations.spec.js",
            testPath + "modules/dataset/filter/models/FilterTableInfo.spec.js",
            testPath + "modules/dataset/filter/models/FilterZones.spec.js",

            testPath + "visual-element/map/models/Shapes.spec.js",
            testPath + "visual-element/map/models/ShapesApi.spec.js",
            testPath + "visual-element/map/models/ShapesStore.spec.js",
            testPath + "visual-element/map/models/GeoJsonConverter.spec.js",

            testPath + "AppRouter.spec.js"
        ];
    </script>

    <script>
        var getScript = function (src, callback) {
            var head = document.getElementsByTagName('head')[0];
            var script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = src;
            head.appendChild(script);
            script.onload = callback;
            script.onerror = function () {
                console.log("Error loading" + src);
                callback();
            }
        };
        var all = src.concat(tests);

        //    for(var i = 0; i < all.length; i++) {
        //        all[i] = all[i] + "?_nocache=" + Math.random();
        //    }

        function getNextScript() {
            if (all.length == 0) {
                mocha.run();
            } else {
                var script = all.shift();
                getScript(script, function () {
                    getNextScript()
                });
            }
        }
        getNextScript();
    </script>


</body>

</html>